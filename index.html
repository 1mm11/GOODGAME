<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>GoodGame Store - Beta Platform</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap');
        
        * { box-sizing: border-box; }
        body { margin: 0; background: #0f0f12; color: #fff; font-family: 'Inter', sans-serif; overflow-x: hidden; }
        
        /* === UI –ü–õ–ê–¢–§–û–†–ú–´ === */
        .page { display: none; padding: 20px; min-height: 100vh; }
        .page.active { display: block; }

        /* –í–•–û–î */
        #login-page { display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100vh; background: radial-gradient(circle, #1a202c, #000); }
        .auth-box { background: #1e1e24; padding: 40px; border-radius: 12px; border: 1px solid #333; width: 300px; text-align: center; }
        input { width: 100%; padding: 10px; margin: 10px 0; background: #0f0f12; border: 1px solid #444; color: white; border-radius: 5px; }
        
        /* –ì–õ–ê–í–ù–ê–Ø */
        header { display: flex; justify-content: space-between; align-items: center; padding: 20px 40px; background: #16161a; border-bottom: 1px solid #333; }
        .logo { font-weight: 900; font-size: 24px; color: #fff; letter-spacing: -1px; }
        .logo span { color: #00e5ff; }
        
        .nav-btn { background: none; border: none; color: #aaa; font-weight: bold; cursor: pointer; font-size: 16px; margin-left: 20px; }
        .nav-btn:hover { color: #fff; }
        .nav-btn.active { color: #00e5ff; }

        .dev-badge { background: #00ff00; color: #000; padding: 2px 6px; border-radius: 4px; font-size: 10px; font-weight: bold; vertical-align: middle; }

        /* –ò–ì–†–´ */
        .games-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 20px; padding: 40px; }
        .game-card { background: #1e1e24; border-radius: 10px; overflow: hidden; transition: 0.2s; border: 1px solid #333; position: relative; }
        .game-card:hover { transform: translateY(-5px); border-color: #00e5ff; }
        .card-img { height: 140px; background: #333; display: flex; align-items: center; justify-content: center; font-size: 40px; }
        .card-info { padding: 15px; }
        .card-title { font-weight: bold; font-size: 18px; margin-bottom: 5px; }
        .card-status { font-size: 12px; color: #aaa; margin-bottom: 10px; }
        
        .btn { width: 100%; padding: 10px; border: none; border-radius: 5px; cursor: pointer; font-weight: bold; transition: 0.2s; }
        .btn-primary { background: #0077ff; color: white; }
        .btn-primary:hover { background: #0055ff; }
        .btn-beta { background: #ffaa00; color: #000; }
        .btn-success { background: #00e5ff; color: #000; box-shadow: 0 0 10px rgba(0,229,255,0.3); }
        .btn-disabled { background: #333; color: #666; cursor: not-allowed; }

        /* –ê–î–ú–ò–ù –ü–ê–ù–ï–õ–¨ */
        .admin-panel { background: #112211; border: 1px solid #00ff00; padding: 20px; margin: 20px; border-radius: 8px; }
        .admin-h { color: #00ff00; font-family: monospace; margin-bottom: 15px; }
        .req-item { display: flex; justify-content: space-between; background: rgba(0,255,0,0.1); padding: 10px; margin-bottom: 5px; border-radius: 4px; }

        /* –ò–ì–†–û–í–û–ô –ö–û–ù–¢–ï–ô–ù–ï–† (–°–∫—Ä—ã—Ç –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) */
        #game-container { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #000; z-index: 1000; display: none; }
        #close-game { position: absolute; top: 20px; right: 20px; z-index: 1001; background: red; color: white; border: none; padding: 10px 20px; cursor: pointer; }
    </style>
</head>
<body>

    <div id="login-page" class="page active">
        <div class="auth-box">
            <h2 style="margin-top:0">GOODGAME <span style="color:#00e5ff">ID</span></h2>
            <input type="text" id="login-user" placeholder="–õ–æ–≥–∏–Ω">
            <input type="password" id="login-pass" placeholder="–ü–∞—Ä–æ–ª—å">
            <button class="btn btn-primary" onclick="tryLogin()">–í–û–ô–¢–ò</button>
            <p style="font-size:12px; color:#666; margin-top:10px;">–î–ª—è –∞–¥–º–∏–Ω–∞: vlad01032014v / GOODGAME</p>
        </div>
    </div>

    <div id="main-interface" class="page">
        <header>
            <div class="logo">GOOD<span>GAME</span></div>
            <nav>
                <button class="nav-btn active" onclick="showTab('store')">–ú–ê–ì–ê–ó–ò–ù</button>
                <button class="nav-btn" onclick="showTab('library')">–ë–ò–ë–õ–ò–û–¢–ï–ö–ê</button>
                <button id="dev-btn" class="nav-btn" style="display:none; color:#00ff00" onclick="showTab('dev')">–†–ê–ó–†–ê–ë–û–¢–ö–ê</button>
                <button class="nav-btn" onclick="logout()">–í–´–•–û–î</button>
            </nav>
            <div id="user-display" style="font-size:14px; font-weight:bold;"></div>
        </header>

        <div id="tab-store" class="tab-content">
            <div class="games-grid">
                <div class="game-card">
                    <div class="card-img" style="background: linear-gradient(45deg, #1a202c, #2d3748);">üî´</div>
                    <div class="card-info">
                        <div class="card-title">PolyStrike: EVOLUTION</div>
                        <div class="card-status">–°—Ç–∞—Ç—É—Å: <span style="color:#ffaa00">–ó–ê–ö–†–´–¢–ê–Ø –ë–ï–¢–ê</span></div>
                        <div id="ps-action-area">
                            </div>
                    </div>
                </div>
                 <div class="game-card">
                    <div class="card-img" style="background: linear-gradient(45deg, #2c1a1a, #482d2d);">ü¶ü</div>
                    <div class="card-info">
                        <div class="card-title">Mosquito Simulator</div>
                        <div class="card-status">–°—Ç–∞—Ç—É—Å: <span style="color:#aaa">–í –†–ê–ó–†–ê–ë–û–¢–ö–ï</span></div>
                        <button class="btn btn-disabled">–ù–ï–î–û–°–¢–£–ü–ù–û</button>
                    </div>
                </div>
            </div>

            <div style="padding: 0 40px;">
                <h3>–û—Ç–∑—ã–≤—ã –∏–≥—Ä–æ–∫–æ–≤</h3>
                <div style="background:#1e1e24; padding:15px; margin-bottom:10px; border-radius:8px;">
                    <div style="color:#00e5ff; font-weight:bold; font-size:12px;">X_Gamer_X</div>
                    <div>–ò–≥—Ä–∞ —Ç–æ–ø! –ñ–¥—É –∫–æ–≥–¥–∞ –∞–¥–º–∏–Ω –¥–∞—Å—Ç –¥–æ—Å—Ç—É–ø –∫ –ø–æ–ª–Ω–æ–π –≤–µ—Ä—Å–∏–∏.</div>
                </div>
                <div style="background:#1e1e24; padding:15px; margin-bottom:10px; border-radius:8px;">
                    <div style="color:#00e5ff; font-weight:bold; font-size:12px;">AlexShooter</div>
                    <div>–ì—Ä–∞—Ñ–∏–∫–∞ –æ–≥–æ–Ω—å –¥–ª—è –±—Ä–∞—É–∑–µ—Ä–∞.</div>
                </div>
            </div>
        </div>

        <div id="tab-library" class="tab-content" style="display:none">
            <h2 style="padding:0 40px">–ú–æ–∏ –∏–≥—Ä—ã</h2>
            <div id="lib-grid" class="games-grid">
                <div style="color:#666">–ó–¥–µ—Å—å –ø—É—Å—Ç–æ...</div>
            </div>
        </div>

        <div id="tab-dev" class="tab-content" style="display:none">
            <div class="admin-panel">
                <h3 class="admin-h">CMD: –ü–ê–ù–ï–õ–¨ –£–ü–†–ê–í–õ–ï–ù–ò–Ø B–ï–¢–ê-–¢–ï–°–¢–û–ú</h3>
                <p>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, –°–æ–∑–¥–∞—Ç–µ–ª—å.</p>
                
                <h4>–ó–ê–Ø–í–ö–ò –ù–ê –î–û–°–¢–£–ü (INBOX)</h4>
                <div id="admin-requests-list">
                    <div style="color:#666; font-style:italic">–ù–µ—Ç –Ω–æ–≤—ã—Ö –∑–∞—è–≤–æ–∫</div>
                </div>
            </div>
        </div>
    </div>

    <div id="game-container">
        <button id="close-game" onclick="closeGame()">‚ùå –í–ï–†–ù–£–¢–¨–°–Ø –í GOODGAME</button>
        <iframe id="game-frame" style="width:100%; height:100%; border:none;" src="about:blank"></iframe>
    </div>

    <script>
        /* === –ë–ê–ó–ê –î–ê–ù–ù–´–• (LOCALSTORAGE) === */
        const DB = {
            user: localStorage.getItem('gg_user'),
            isAdmin: false,
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –∑–∞–ø—Ä–æ—Å—ã
            getRequests: () => JSON.parse(localStorage.getItem('gg_requests') || '[]'),
            addRequest: (user) => {
                let reqs = DB.getRequests();
                if(!reqs.includes(user)) {
                    reqs.push(user);
                    localStorage.setItem('gg_requests', JSON.stringify(reqs));
                }
            },
            removeRequest: (user) => {
                let reqs = DB.getRequests().filter(u => u !== user);
                localStorage.setItem('gg_requests', JSON.stringify(reqs));
            },
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–æ—Å—Ç—É–ø—ã (–±–µ–ª—ã–π —Å–ø–∏—Å–æ–∫)
            getAccessList: () => JSON.parse(localStorage.getItem('gg_access') || '[]'),
            grantAccess: (user) => {
                let acc = DB.getAccessList();
                acc.push(user);
                localStorage.setItem('gg_access', JSON.stringify(acc));
            },
            hasAccess: (user) => DB.getAccessList().includes(user)
        };

        /* === –°–ò–°–¢–ï–ú–ê –í–•–û–î–ê === */
        const ADMIN_LOGIN = "vlad01032014v";
        const ADMIN_PASS = "GOODGAME";

        function tryLogin() {
            const u = document.getElementById('login-user').value;
            const p = document.getElementById('login-pass').value;

            if(u === ADMIN_LOGIN && p === ADMIN_PASS) {
                DB.user = u;
                DB.isAdmin = true;
                loginSuccess();
            } else if (u && u !== ADMIN_LOGIN) {
                // –û–±—ã—á–Ω—ã–π —é–∑–µ—Ä
                DB.user = u;
                DB.isAdmin = false;
                loginSuccess();
            } else {
                alert("–ù–µ–≤–µ—Ä–Ω—ã–π –ª–æ–≥–∏–Ω –∏–ª–∏ –Ω–∏–∫ –∑–∞–Ω—è—Ç –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º!");
            }
        }

        function loginSuccess() {
            localStorage.setItem('gg_user', DB.user);
            document.getElementById('login-page').classList.remove('active');
            document.getElementById('main-interface').classList.add('active');
            
            const userDisplay = document.getElementById('user-display');
            userDisplay.innerHTML = `üë§ ${DB.user} ${DB.isAdmin ? '<span class="dev-badge">DEV</span>' : ''}`;
            
            if(DB.isAdmin) {
                document.getElementById('dev-btn').style.display = 'inline-block';
                renderAdminPanel();
            }

            renderStore();
            renderLibrary();
        }

        function logout() {
            localStorage.removeItem('gg_user');
            location.reload();
        }

        /* === –õ–û–ì–ò–ö–ê –ú–ê–ì–ê–ó–ò–ù–ê === */
        function renderStore() {
            const actionArea = document.getElementById('ps-action-area');
            actionArea.innerHTML = '';

            // –ï—Å–ª–∏ –ê–¥–º–∏–Ω - –≤—Å–µ–≥–¥–∞ –∏–≥—Ä–∞—Ç—å
            if(DB.isAdmin) {
                actionArea.innerHTML = `<button class="btn btn-success" onclick="launchGame()">–ó–ê–ü–£–°–¢–ò–¢–¨ –¢–ï–°–¢ (DEV)</button>`;
                return;
            }

            // –ï—Å–ª–∏ –µ—Å—Ç—å –¥–æ—Å—Ç—É–ø
            if(DB.hasAccess(DB.user)) {
                actionArea.innerHTML = `<button class="btn btn-success" onclick="launchGame()">–ò–ì–†–ê–¢–¨</button>`;
            } 
            // –ï—Å–ª–∏ –∑–∞—è–≤–∫–∞ —É–∂–µ –ø–æ–¥–∞–Ω–∞
            else if(DB.getRequests().includes(DB.user)) {
                actionArea.innerHTML = `<button class="btn btn-disabled">–ó–ê–Ø–í–ö–ê –û–¢–ü–†–ê–í–õ–ï–ù–ê...</button><div style="font-size:10px; color:#aaa; margin-top:5px">–û–∂–∏–¥–∞–π—Ç–µ –æ–¥–æ–±—Ä–µ–Ω–∏—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞</div>`;
            } 
            // –ò–Ω–∞—á–µ - –ø–æ–¥–∞—Ç—å –∑–∞—è–≤–∫—É
            else {
                actionArea.innerHTML = `<button class="btn btn-beta" onclick="sendBetaRequest()">–ü–û–î–ê–¢–¨ –ó–ê–Ø–í–ö–£ –ù–ê –ë–ï–¢–£</button>`;
            }
        }

        function sendBetaRequest() {
            DB.addRequest(DB.user);
            renderStore(); // –û–±–Ω–æ–≤–∏—Ç—å –∫–Ω–æ–ø–∫—É
            alert("–ó–∞—è–≤–∫–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫—É (vlad01032014v)!");
        }

        /* === –õ–û–ì–ò–ö–ê –ê–î–ú–ò–ù–ê === */
        function renderAdminPanel() {
            const list = document.getElementById('admin-requests-list');
            const reqs = DB.getRequests();
            
            if(reqs.length === 0) {
                list.innerHTML = '<div style="color:#666">–ù–µ—Ç –Ω–æ–≤—ã—Ö –∑–∞—è–≤–æ–∫</div>';
                return;
            }

            list.innerHTML = '';
            reqs.forEach(user => {
                const item = document.createElement('div');
                item.className = 'req-item';
                item.innerHTML = `
                    <span style="color:#fff">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: <b>${user}</b> –ø—Ä–æ—Å–∏—Ç –¥–æ—Å—Ç—É–ø</span>
                    <div>
                        <button style="background:green; color:white; border:none; cursor:pointer;" onclick="adminApprove('${user}')">–ü–†–ò–ù–Ø–¢–¨</button>
                        <button style="background:red; color:white; border:none; cursor:pointer;" onclick="adminReject('${user}')">–û–¢–ö–õ–û–ù–ò–¢–¨</button>
                    </div>
                `;
                list.appendChild(item);
            });
        }

        function adminApprove(user) {
            DB.removeRequest(user);
            DB.grantAccess(user);
            renderAdminPanel();
            alert(`–î–æ—Å—Ç—É–ø –≤—ã–¥–∞–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é ${user}. –û–Ω –ø–æ–ª—É—á–∏–ª –∫–æ–¥ –¥–æ—Å—Ç—É–ø–∞.`);
        }

        function adminReject(user) {
            DB.removeRequest(user);
            renderAdminPanel();
        }

        /* === –ë–ò–ë–õ–ò–û–¢–ï–ö–ê === */
        function renderLibrary() {
            const grid = document.getElementById('lib-grid');
            if(DB.hasAccess(DB.user) || DB.isAdmin) {
                grid.innerHTML = `
                <div class="game-card">
                    <div class="card-img" style="background: linear-gradient(45deg, #0077ff, #00e5ff);">‚ö°</div>
                    <div class="card-info">
                        <div class="card-title">PolyStrike</div>
                        <div class="card-status">–í –±–∏–±–ª–∏–æ—Ç–µ–∫–µ</div>
                        <button class="btn btn-success" onclick="launchGame()">–ó–ê–ü–£–°–¢–ò–¢–¨</button>
                    </div>
                </div>`;
            } else {
                grid.innerHTML = '<div style="color:#666">–í–∞—à–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –ø—É—Å—Ç–∞.</div>';
            }
        }

        /* === –¢–ê–ë–´ === */
        function showTab(name) {
            document.querySelectorAll('.tab-content').forEach(t => t.style.display = 'none');
            document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
            document.getElementById('tab-' + name).style.display = 'block';
            
            if(name === 'dev') renderAdminPanel();
        }

        /* === –ó–ê–ü–£–°–ö –ò–ì–†–´ === */
        // –°—é–¥–∞ –º—ã –≤—Å—Ç–∞–≤–ª—è–µ–º –∫–æ–¥ –∏–≥—Ä—ã
        function launchGame() {
            document.getElementById('game-container').style.display = 'block';
            const frame = document.getElementById('game-frame');
            
            // –ì–ï–ù–ï–†–ê–¶–ò–Ø –ò–ì–†–´ "–ù–ê –õ–ï–¢–£" –í–ù–£–¢–†–ò IFRAME
            const gameCode = `
                <!DOCTYPE html>
                <html>
                <head>
                    <style>body{margin:0; overflow:hidden; background:black; color:white; font-family:sans-serif; text-align:center;}</style>
                    <title>PolyStrike Game</title>
                </head>
                <body>
                    <h2 style="position:absolute; z-index:10; color:white; top:10px; left:10px;">PolyStrike Beta</h2>
                    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"><\/script>
                    <script>
                        // –ü–†–û–°–¢–û–ô –ü–†–ò–ú–ï–† –ò–ì–†–´ –î–õ–Ø –¢–ï–°–¢–ê (–ß—Ç–æ–±—ã –Ω–µ –¥—É–±–ª–∏—Ä–æ–≤–∞—Ç—å –æ–≥—Ä–æ–º–Ω—ã–π –∫–æ–¥)
                        // –í –†–ï–ê–õ–¨–ù–û–°–¢–ò –°–Æ–î–ê –ú–û–ñ–ù–û –í–°–¢–ê–í–ò–¢–¨ –í–ï–°–¨ –ö–û–î POLYSTRIKE
                        
                        const scene = new THREE.Scene();
                        const camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 1000);
                        const renderer = new THREE.WebGLRenderer();
                        renderer.setSize(window.innerWidth, window.innerHeight);
                        document.body.appendChild(renderer.domElement);

                        const geometry = new THREE.BoxGeometry();
                        const material = new THREE.MeshBasicMaterial({ color: 0x00ff00, wireframe: true });
                        const cube = new THREE.Mesh(geometry, material);
                        scene.add(cube);
                        camera.position.z = 5;

                        function animate() {
                            requestAnimationFrame(animate);
                            cube.rotation.x += 0.01;
                            cube.rotation.y += 0.01;
                            renderer.render(scene, camera);
                        }
                        animate();
                        
                        // –≠–º—É–ª—è—Ü–∏—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
                        document.body.onclick = () => document.body.requestPointerLock();
                    <\/script>
                </body>
                </html>
            `;
            
            // –í—Å—Ç–∞–≤–ª—è–µ–º –∫–æ–¥ –∏–≥—Ä—ã –≤ iframe
            frame.contentWindow.document.open();
            frame.contentWindow.document.write(gameCode);
            frame.contentWindow.document.close();
        }

        function closeGame() {
            document.getElementById('game-container').style.display = 'none';
            document.getElementById('game-frame').src = 'about:blank'; // –û—á–∏—Å—Ç–∫–∞
        }

        // –ê–≤—Ç–æ-–ª–æ–≥–∏–Ω –µ—Å–ª–∏ –æ–±–Ω–æ–≤–ª—è–ª–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—É
        if(localStorage.getItem('gg_user')) {
            DB.user = localStorage.getItem('gg_user');
            DB.isAdmin = (DB.user === ADMIN_LOGIN);
            document.getElementById('login-page').classList.remove('active');
            document.getElementById('main-interface').classList.add('active');
            
            const userDisplay = document.getElementById('user-display');
            userDisplay.innerHTML = `üë§ ${DB.user} ${DB.isAdmin ? '<span class="dev-badge">DEV</span>' : ''}`;
            
            if(DB.isAdmin) {
                document.getElementById('dev-btn').style.display = 'inline-block';
            }
            renderStore();
            renderLibrary();
        }
    </script>
</body>
</html>
